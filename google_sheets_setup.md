# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Google Sheets

## üîß –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Google Cloud Console

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í–∫–ª—é—á–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ API:
   - Google Sheets API
   - Google Drive API

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞

1. –í Google Cloud Console –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "IAM & Admin" ‚Üí "Service Accounts"
2. –ù–∞–∂–º–∏—Ç–µ "Create Service Account"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–µ—Ç–∞–ª–∏:
   - –ò–º—è: `flower-forecast-service`
   - –û–ø–∏—Å–∞–Ω–∏–µ: `Service account for flower forecast system`
4. –ù–∞–∂–º–∏—Ç–µ "Create and Continue"
5. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å: "Editor" –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—É—é —Ä–æ–ª—å —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ Sheets
6. –ù–∞–∂–º–∏—Ç–µ "Done"

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞

1. –ù–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –≤ —Å–ø–∏—Å–∫–µ
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ email —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Keys"
4. –ù–∞–∂–º–∏—Ç–µ "Add Key" ‚Üí "Create new key"
5. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø "JSON"
6. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª –∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –µ–≥–æ –≤ `service_account_key.json`
7. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ Google –¢–∞–±–ª–∏—Ü—ã

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é Google –¢–∞–±–ª–∏—Ü—É
2. –°–æ–∑–¥–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ª–∏—Å—Ç—ã:

#### –õ–∏—Å—Ç "–ü—Ä–æ–¥–∞–∂–∏"
```
A1: –î–∞—Ç–∞ | B1: –ú–∞–≥–∞–∑–∏–Ω | C1: SKU | D1: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | E1: –¶–µ–Ω–∞ | F1: –î–µ–Ω—å_–Ω–µ–¥–µ–ª–∏ | G1: –ú–µ—Å—è—Ü
```

#### –õ–∏—Å—Ç "–û—Å—Ç–∞—Ç–∫–∏"
```
A1: –î–∞—Ç–∞ | B1: –ú–∞–≥–∞–∑–∏–Ω | C1: SKU | D1: –û—Å—Ç–∞—Ç–æ–∫ | E1: –°—Ä–æ–∫_–≥–æ–¥–Ω–æ—Å—Ç–∏ | F1: –ü–æ—Å—Ç–∞–≤—â–∏–∫
```

#### –õ–∏—Å—Ç "–ü—Ä–æ–≥–Ω–æ–∑"
```
A1: –î–∞—Ç–∞ | B1: –ú–∞–≥–∞–∑–∏–Ω | C1: SKU | D1: –ü—Ä–æ–≥–Ω–æ–∑_—Å–ø—Ä–æ—Å–∞ | E1: –¢–µ–∫—É—â–∏–π_–æ—Å—Ç–∞—Ç–æ–∫ | F1: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è_–∑–∞–∫—É–ø–∫–∏ | G1: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç
```

#### –õ–∏—Å—Ç "–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏"
```
A1: –î–∞—Ç–∞ | B1: –ú–∞–≥–∞–∑–∏–Ω | C1: SKU | D1: –°—Ç–∞—Ä–æ–µ_–∑–Ω–∞—á–µ–Ω–∏–µ | E1: –ù–æ–≤–æ–µ_–∑–Ω–∞—á–µ–Ω–∏–µ | F1: –ü—Ä–∏—á–∏–Ω–∞ | G1: –í—Ä–µ–º—è_–∏–∑–º–µ–Ω–µ–Ω–∏—è
```

### –®–∞–≥ 5: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ email —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏–∑ —Ñ–∞–π–ª–∞ JSON (–ø–æ–ª–µ "client_email")
2. –í Google –¢–∞–±–ª–∏—Ü–µ –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
3. –í—Å—Ç–∞–≤—å—Ç–µ email —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
4. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∞ "–†–µ–¥–∞–∫—Ç–æ—Ä"
5. –°–Ω–∏–º–∏—Ç–µ –≥–∞–ª–æ—á–∫—É "–£–≤–µ–¥–æ–º–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"
6. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"

### –®–∞–≥ 6: –ü–æ–ª—É—á–µ–Ω–∏–µ URL —Ç–∞–±–ª–∏—Ü—ã

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL –≤–∞—à–µ–π Google –¢–∞–±–ª–∏—Ü—ã
2. URL –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
   `https://docs.google.com/spreadsheets/d/–í–ê–®–ê_–¢–ê–ë–õ–ò–¶–ê_ID/edit`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `test_connection.py`:

```python
import gspread
from google.oauth2.service_account import Credentials

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
CREDENTIALS_PATH = "service_account_key.json"
SPREADSHEET_URL = "–í–ê–®–ê_–°–°–´–õ–ö–ê_–ù–ê_–¢–ê–ë–õ–ò–¶–£"

def test_connection():
    try:
        # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
        scope = ['https://spreadsheets.google.com/feeds',
                'https://www.googleapis.com/auth/drive']
        
        creds = Credentials.from_service_account_file(
            CREDENTIALS_PATH, scopes=scope
        )
        
        gc = gspread.authorize(creds)
        sheet = gc.open_by_url(SPREADSHEET_URL)
        
        print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!")
        print(f"–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã: {sheet.title}")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏—Å—Ç–æ–≤
        worksheets = sheet.worksheets()
        print(f"–ù–∞–π–¥–µ–Ω–æ –ª–∏—Å—Ç–æ–≤: {len(worksheets)}")
        
        for ws in worksheets:
            print(f"  - {ws.title}")
            
        return True
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: {e}")
        return False

if __name__ == "__main__":
    test_connection()
```

## üìä –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–∞–Ω–Ω—ã–µ –¥–ª—è –ª–∏—Å—Ç–∞ "–ü—Ä–æ–¥–∞–∂–∏":
```
2025-06-01,–ê–ª–º–∞—Ç—ã_1,–†–æ–∑–∞_–∫—Ä–∞—Å–Ω–∞—è_60—Å–º,15,2500,Saturday,6
2025-06-01,–ê–ª–º–∞—Ç—ã_1,–¢—é–ª—å–ø–∞–Ω_–±–µ–ª—ã–π,8,800,Saturday,6
2025-06-02,–ê–ª–º–∞—Ç—ã_2,–†–æ–∑–∞_–∫—Ä–∞—Å–Ω–∞—è_60—Å–º,23,2300,Sunday,6
```

### –î–∞–Ω–Ω—ã–µ –¥–ª—è –ª–∏—Å—Ç–∞ "–û—Å—Ç–∞—Ç–∫–∏":
```
2025-06-06,–ê–ª–º–∞—Ç—ã_1,–†–æ–∑–∞_–∫—Ä–∞—Å–Ω–∞—è_60—Å–º,12,2025-06-10,–ü–æ—Å—Ç–∞–≤—â–∏–∫_–ê
2025-06-06,–ê–ª–º–∞—Ç—ã_1,–¢—é–ª—å–ø–∞–Ω_–±–µ–ª—ã–π,5,2025-06-08,–ü–æ—Å—Ç–∞–≤—â–∏–∫_–ë
2025-06-06,–ê–ª–º–∞—Ç—ã_2,–†–æ–∑–∞_–∫—Ä–∞—Å–Ω–∞—è_60—Å–º,18,2025-06-09,–ü–æ—Å—Ç–∞–≤—â–∏–∫_–ê
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–í–ê–ñ–ù–û:**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Ñ–∞–π–ª `service_account_key.json` –≤ Git
- –î–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ `.gitignore`
- –†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç–∏—Ä—É–π—Ç–µ –∫–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "Permission denied"
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü—É —Å –ø—Ä–∞–≤–∞–º–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ API –≤–∫–ª—é—á–µ–Ω—ã –≤ Google Cloud Console

### –û—à–∏–±–∫–∞ "Worksheet not found"
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ª–∏—Å—Ç—ã —Å–æ–∑–¥–∞–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–π –ª–∏—Å—Ç–æ–≤ (—Ä–µ–≥–∏—Å—Ç—Ä –≤–∞–∂–µ–Ω)

### –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∫–ª—é—á–µ–π
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª JSON –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –ª–∏—Å—Ç "–ü—Ä–æ–¥–∞–∂–∏"
2. –û–±–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–µ –æ—Å—Ç–∞—Ç–∫–∏ –≤ –ª–∏—Å—Ç–µ "–û—Å—Ç–∞—Ç–∫–∏"
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ª–∏—Å—Ç–µ "–ü—Ä–æ–≥–Ω–æ–∑"